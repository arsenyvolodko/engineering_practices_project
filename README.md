## Titanic project

### Общее описание
Предсказание выживаемости пассажиров Титаника с использованием алгоритмов машинного обучения.

### Использованные библиотеки
- `pandas`, `numpy` - для работы с данными
- `matplotlib`, `seaborn` - для визуализации данных
- `sklearn` - для работы с алгоритмами машинного обучения
- `joblib`, `snakemake` - для автоматизации процесса обработки данных

### Пакетный менеджер
В качестве пакетного менеджера используется `poetry`.
Для активации виртуального окружения необходимо выполнить команду `poetry shell` и `poetry install --no-root` для установки зависимостей.

### Pipeline
Для автоматизации процесса обработки данных используется `snakemake`.
`snakefile` включает в себя 3 подзадачи (rule):
1. preprocess_data - предобработка данных
2. train_model - обучение моделей
3. predict - предсказание выживаемости

Для запуска pipeline необходимо выполнить команду `snakemake --cores all -R {task_name}`, где `task_name` - название подзадачи.


### Подробное описание
1. #### Предобработка данных
Предобработка данных производится в файле `titanic_project/preprocess_data.py`. 
Для удобства работы с данными датасеты из файлов `train.csv` и `test.csv` объединяются в один датасет.
В рамках разведочного анализа, строятся диаграммы распределений пасажиров по каждому из признаков, а так же графики совместного распределения для всех признаков.
Кроме того, составляется средний портрет пассажира для каждого из класса, представленного на борту Титаника, а также для различных возрастных групп пассажиров.
В рамках обработки данных, производится удаление пропущенных значений, удаление лишних колонок, кодирование категориальных признаков, а также масштабирование данных.
После чего, данные сохраняются в файл `data/processed_data.csv`.

2. #### Обучение моделей
Обучение моделей производится в файле `titanic_project/train_model.py`.
В рамках обучения моделей, производится разбиение данных на обучающую и тестовую выборки, а также обучение моделей с использованием logistic regression, decision tree, SVM.
Обученные модели сохраняются в файле `models/model.pkl`.

3. #### Предсказание выживаемости
Предсказание выживаемости производится в файле `titanic_project/predict_model.py`, а результаты сохраняются в файле `results/predictions.txt`.

### Результаты
Точность предсказания выживаемости пассажиров на тестовой выборке составила:
- logistic regression - 0.76
- decision tree - 0.75
- SVM - 0.79
